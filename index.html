<!doctype html><html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json"><meta name="theme-color" content="#111827">
<title>TIMEFINDR — Inventario & Invoices</title>
<link rel="icon" href="icons/icon-192.png"><link rel="apple-touch-icon" href="icons/icon-192.png">
<link rel="stylesheet" href="styles.css"></head><body>
<header><div class="wrap"><div style="display:flex;align-items:center;gap:12px">
<img id="brand-logo" class="logo" style="width:36px;height:36px;border-radius:8px;background:radial-gradient(circle at 30% 30%,#22d3ee,#0ea5e9)" alt="logo">
<div><strong>TIMEFINDR</strong><div class="muted">Inventario · Socios · Invoices</div></div></div>
<nav><button id="tab-inv" class="active">Inventario</button><button id="tab-new">Nueva pieza</button><button id="tab-fin">Cuentas por cobrar</button><button id="tab-settings">Ajustes</button></nav></div></header>
<main class="wrap">
<section id="view-inv" class="panel">
  <div style="display:flex;justify-content:space-between;gap:8px;flex-wrap:wrap;align-items:center">
    <h2>Inventario</h2>
    <div style="display:flex;gap:8px"><input id="q" placeholder="Buscar modelo, ref, serie..." style="min-width:220px">
    <button class="btn secondary" onclick="exportCSV()">CSV</button><button class="btn secondary" onclick="backupJSON()">Backup</button>
    <label class="btn secondary" for="restore-file">Restaurar</label><input id="restore-file" type="file" accept="application/json" style="display:none" onchange="restoreJSON(event)"></div>
  </div>
  <table id="inv-table"><thead><tr><th>Modelo</th><th>Ref.</th><th>Serie</th><th>Año</th><th>Cond.</th><th>Moneda</th><th class="right">Precio</th><th>Crédito</th><th></th></tr></thead><tbody></tbody></table>
</section>
<section id="view-new" class="panel" style="display:none">
  <h2>Nueva / Editar pieza</h2>
  <div class="row row-3">
    <div><label>Modelo</label><input id="f-model"></div>
    <div><label>Referencia</label><div style="display:flex;gap:8px"><input id="f-ref"><button class="btn secondary" onclick="scanBarcode('f-ref')">Scan</button></div></div>
    <div><label>Serie</label><div style="display:flex;gap:8px"><input id="f-serial"><button class="btn secondary" onclick="scanBarcode('f-serial')">Scan</button></div></div>
    <div><label>Año</label><input id="f-year" type="number" min="1900" max="2100"></div>
    <div><label>Condición</label><select id="f-cond"><option>Nuevo sellado</option><option>Como nuevo</option><option>Excelente</option><option>Bueno</option><option>Usado</option></select></div>
    <div><label>Contenido</label><input id="f-contents" placeholder="Caja, papeles..."></div>
    <div><label>Moneda</label><select id="f-currency"><option>USD</option><option>MXN</option></select></div>
    <div><label>Precio venta</label><input id="f-sell" type="number" step="0.01"></div>
    <div><label>Tipo de cambio</label><input id="f-fx" type="number" step="0.0001" placeholder="Ej. 17.20"></div>
    <div><label>COGS</label><input id="f-cost" type="number" step="0.01"></div>
    <div><label>Otros costos</label><input id="f-extra" type="number" step="0.01" value="0"></div>
    <div><label>Impuesto (%)</label><input id="f-tax" type="number" step="0.01" value="0"></div>
    <div><label>Cliente</label><input id="f-client"></div>
    <div><label>Email cliente</label><input id="f-client-email" type="email"></div>
    <div><label>Crédito</label><select id="f-credit"><option value="0">Contado</option><option value="15">15 d</option><option value="30">30 d</option><option value="40">40 d</option><option value="60">60 d</option></select></div>
  </div>
  <div style="margin-top:8px"><label>Fotos</label><input id="f-photos" type="file" accept="image/*" capture="environment" multiple onchange="handlePhotos(event)">
  <div id="photos-preview" class="gallery"></div><div class="muted">Se comprimen para ahorrar espacio.</div></div>
  <div class="panel" style="border-style:dashed"><div style="display:flex;justify-content:space-between;align-items:center">
    <strong>Socios</strong><button class="btn secondary" onclick="addPartnerRow()">+ Socio</button></div><div id="partners-list" class="row"></div>
    <div class="muted">Se devuelve aporte (COGS+extras) y utilidad neta por porcentaje.</div></div>
  <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap"><button class="btn" onclick="savePiece()">Guardar</button><button class="btn secondary" onclick="resetForm()">Limpiar</button></div>
</section>
<section id="view-rcv" class="panel" style="display:none"><div style="display:flex;justify-content:space-between;align-items:center">
  <h2>Cuentas por cobrar</h2><div class="muted">Hoy: <span id="today"></span></div></div>
  <table id="rcv-table"><thead><tr><th>Folio</th><th>Cliente</th><th>Pieza</th><th>Emisión</th><th>Vence</th><th class="right">Saldo</th><th></th></tr></thead><tbody></tbody></table>
</section>
<section id="view-settings" class="panel" style="display:none">
  <h2>Ajustes</h2>
  <div class="row"><div><label>Negocio</label><input id="s-biz" value="TIMEFINDR LLC"></div><div><label>Correo</label><input id="s-email" value="ventas@timefindr.com"></div>
  <div><label>Teléfono</label><input id="s-phone" value="+52 55 6318 4206"></div><div><label>Dirección</label><input id="s-addr" value="169 East Flagler St, Suite 1629, Miami, FL 33131"></div></div>
  <div class="row"><div><label>Prefijo folio</label><input id="s-prefix" value="TF"></div><div><label>Impuesto def. (%)</label><input id="s-tax" type="number" value="0"></div>
  <div><label>Moneda def.</label><select id="s-cur"><option>USD</option><option>MXN</option></select></div><div><label>Logo</label><input id="s-logo" type="file" accept="image/*" onchange="handleLogo(event)"></div></div>
  <h3>Pagos</h3><div class="row"><div><label>CLABE MX</label><input id="s-clabe"></div><div><label>Wire US</label><input id="s-wire"></div><div><label>Stripe</label><input id="s-stripe"></div><div><label>Crypto</label><input id="s-crypto"></div></div>
  <h3>Términos</h3><textarea id="s-terms" rows="3">Propiedad hasta pago total. No hay devoluciones en piezas selladas. Pagos por transferencia.</textarea>
  <h3>Cloud (opcional)</h3><div class="row"><div><label>SUPABASE URL</label><input id="s-supa-url" placeholder="https://..."></div><div><label>SUPABASE KEY</label><input id="s-supa-key" placeholder="ey..."></div></div>
  <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" onclick="saveSettings()">Guardar ajustes</button><button id="btn-sync" class="btn secondary" style="display:none" onclick="syncCloud()">Sync cloud</button></div>
</section>
</main>
<footer class="wrap"><div>© <span id="y"></span> TIMEFINDR — PWA v2</div></footer>
<script src="app.js"></script></body></html>
